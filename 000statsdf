local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/1NFERNO-HUB/Main/refs/heads/main/Settings/UI/1NFERNO_Library.lua"))()
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

local Window = Library:CreateWindow({
    Title = "Player Stats Viewer",
    Description = "v1.0",
    ["Tab Width"] = 150,
    SizeUi = UDim2.fromOffset(600, 450)
})

local StatsTab = Window:CreateTab({
    Name = "Player Stats",
    Icon = "rbxassetid://7733673987"
})

StatsTab:AddParagraph({
    Title = "Stats Dashboard",
    Content = "Select a player to view live stats"
})

StatsTab:AddSeperator({
    Title = "Player Selection"
})

local function GetPlayerOptions()
    local t = {}
    for _, plr in ipairs(Players:GetPlayers()) do
        table.insert(t, plr.DisplayName)
    end
    return t
end

local SelectedPlayer = nil
local PreviousStats = {}
local CumulativeGains = {}
local SelectionTime = 0

StatsTab:AddDropdown({
    Title = "Select Player",
    Content = "Choose a player",
    Multi = false,
    Options = GetPlayerOptions(),
    Default = {},
    Callback = function(sel)
        SelectedPlayer = nil
        PreviousStats = {}
        CumulativeGains = {}
        SelectionTime = 0
        if sel and sel[1] then
            for _, plr in ipairs(Players:GetPlayers()) do
                if plr.DisplayName == sel[1] then
                    SelectedPlayer = plr
                    SelectionTime = 0
                    break
                end
            end
        end
    end
})

local function FormatNumber(num)
    if not num then return "0", "0" end
    local real = tostring(math.floor(num)):reverse():gsub("(%d%d%d)", "%1,"):reverse():gsub("^,", "")
    local abs = math.abs(num)
    local suffix = {"","K","M","B","T","Qa","Qi"}
    local i = 1
    while abs >= 1000 and i < #suffix do
        abs = abs / 1000
        i = i + 1
    end
    local short = string.format("%.2f%s", abs, suffix[i])
    return real, short
end

local function FormatTime(seconds)
    seconds = math.floor(seconds)
    
    local days = math.floor(seconds / 86400)
    local hours = math.floor((seconds % 86400) / 3600)
    local minutes = math.floor((seconds % 3600) / 60)
    local secs = seconds % 60
    
    local parts = {}
    
    if days > 0 then
        table.insert(parts, days .. " day" .. (days ~= 1 and "s" or ""))
    end
    if hours > 0 then
        table.insert(parts, hours .. " hour" .. (hours ~= 1 and "s" or ""))
    end
    if minutes > 0 then
        table.insert(parts, minutes .. " minute" .. (minutes ~= 1 and "s" or ""))
    end
    if secs > 0 or #parts == 0 then
        table.insert(parts, secs .. " second" .. (secs ~= 1 and "s" or ""))
    end
    
    if #parts == 1 then
        return parts[1]
    elseif #parts == 2 then
        return parts[1] .. " and " .. parts[2]
    else
        return table.concat(parts, ", ", 1, #parts - 1) .. " and " .. parts[#parts]
    end
end

local StatsSection = StatsTab:AddSection("Player Stats", true)
local AllStatsP = StatsSection:AddParagraph({
    Title = "Stats",
    Content = "N/A"
})

local GainsP = StatsSection:AddParagraph({
    Title = "Gains",
    Content = "N/A"
})


task.spawn(function()
    while task.wait(0.3) do
        if not SelectedPlayer then
            AllStatsP:Set({
                Title = "Stats",
                Content = "Select a player"
            })
            GainsP:Set({
                Title = "Gains",
                Content = "Select a player"
            })
        else
            SelectionTime = SelectionTime + 0.3
            local timerDisplay = FormatTime(SelectionTime)
            
            local ls = SelectedPlayer:FindFirstChild("leaderstats")
            local statsText = ""
            local gainsText = ""
            
            if ls then
                if ls:FindFirstChild("Strength") then
                    local full, short = FormatNumber(ls.Strength.Value)
                    statsText = statsText .. "Strength: " .. full .. " | " .. short .. "\n"
                    
                    if not PreviousStats.Strength then
                        PreviousStats.Strength = ls.Strength.Value
                        CumulativeGains.Strength = 0
                    end
                    
                    local gain = ls.Strength.Value - PreviousStats.Strength
                    if gain > 0 then
                        CumulativeGains.Strength = CumulativeGains.Strength + gain
                        PreviousStats.Strength = ls.Strength.Value
                    end
                    
                    local gainFull, gainShort = FormatNumber(CumulativeGains.Strength)
                    gainsText = gainsText .. "Strength: +" .. gainFull .. " | +" .. gainShort .. "\n"
                end
                if ls:FindFirstChild("Rebirths") then
                    local full, short = FormatNumber(ls.Rebirths.Value)
                    statsText = statsText .. "Rebirths: " .. full .. " | " .. short .. "\n"
                    
                    if not PreviousStats.Rebirths then
                        PreviousStats.Rebirths = ls.Rebirths.Value
                        CumulativeGains.Rebirths = 0
                    end
                    
                    local gain = ls.Rebirths.Value - PreviousStats.Rebirths
                    if gain > 0 then
                        CumulativeGains.Rebirths = CumulativeGains.Rebirths + gain
                        PreviousStats.Rebirths = ls.Rebirths.Value
                    end
                    
                    local gainFull, gainShort = FormatNumber(CumulativeGains.Rebirths)
                    gainsText = gainsText .. "Rebirths: +" .. gainFull .. " | +" .. gainShort .. "\n"
                end
                if ls:FindFirstChild("Kills") then
                    local full, short = FormatNumber(ls.Kills.Value)
                    statsText = statsText .. "Kills: " .. full .. " | " .. short .. "\n"
                    
                    if not PreviousStats.Kills then
                        PreviousStats.Kills = ls.Kills.Value
                        CumulativeGains.Kills = 0
                    end
                    
                    local gain = ls.Kills.Value - PreviousStats.Kills
                    if gain > 0 then
                        CumulativeGains.Kills = CumulativeGains.Kills + gain
                        PreviousStats.Kills = ls.Kills.Value
                    end
                    
                    local gainFull, gainShort = FormatNumber(CumulativeGains.Kills)
                    gainsText = gainsText .. "Kills: +" .. gainFull .. " | +" .. gainShort .. "\n"
                end
            end

            if SelectedPlayer:FindFirstChild("Gems") then
                local full, short = FormatNumber(SelectedPlayer.Gems.Value)
                statsText = statsText .. "Gems: " .. full .. " | " .. short .. "\n"
                
                if not PreviousStats.Gems then
                    PreviousStats.Gems = SelectedPlayer.Gems.Value
                    CumulativeGains.Gems = 0
                end
                
                local gain = SelectedPlayer.Gems.Value - PreviousStats.Gems
                if gain > 0 then
                    CumulativeGains.Gems = CumulativeGains.Gems + gain
                    PreviousStats.Gems = SelectedPlayer.Gems.Value
                end
                
                local gainFull, gainShort = FormatNumber(CumulativeGains.Gems)
                gainsText = gainsText .. "Gems: +" .. gainFull .. " | +" .. gainShort .. "\n"
            end
            if SelectedPlayer:FindFirstChild("Durability") then
                local full, short = FormatNumber(SelectedPlayer.Durability.Value)
                statsText = statsText .. "Durability: " .. full .. " | " .. short .. "\n"
                
                if not PreviousStats.Durability then
                    PreviousStats.Durability = SelectedPlayer.Durability.Value
                    CumulativeGains.Durability = 0
                end
                
                local gain = SelectedPlayer.Durability.Value - PreviousStats.Durability
                if gain > 0 then
                    CumulativeGains.Durability = CumulativeGains.Durability + gain
                    PreviousStats.Durability = SelectedPlayer.Durability.Value
                end
                
                local gainFull, gainShort = FormatNumber(CumulativeGains.Durability)
                gainsText = gainsText .. "Durability: +" .. gainFull .. " | +" .. gainShort .. "\n"
            end
            if SelectedPlayer:FindFirstChild("Agility") then
                local full, short = FormatNumber(SelectedPlayer.Agility.Value)
                statsText = statsText .. "Agility: " .. full .. " | " .. short .. "\n"
                
                if not PreviousStats.Agility then
                    PreviousStats.Agility = SelectedPlayer.Agility.Value
                    CumulativeGains.Agility = 0
                end
                
                local gain = SelectedPlayer.Agility.Value - PreviousStats.Agility
                if gain > 0 then
                    CumulativeGains.Agility = CumulativeGains.Agility + gain
                    PreviousStats.Agility = SelectedPlayer.Agility.Value
                end
                
                local gainFull, gainShort = FormatNumber(CumulativeGains.Agility)
                gainsText = gainsText .. "Agility: +" .. gainFull .. " | +" .. gainShort .. "\n"
            end
            if SelectedPlayer:FindFirstChild("evilKarma") then
                local full, short = FormatNumber(SelectedPlayer.evilKarma.Value)
                statsText = statsText .. "Evil Karma: " .. full .. " | " .. short .. "\n"
                
                if not PreviousStats.evilKarma then
                    PreviousStats.evilKarma = SelectedPlayer.evilKarma.Value
                    CumulativeGains.evilKarma = 0
                end
                
                local gain = SelectedPlayer.evilKarma.Value - PreviousStats.evilKarma
                if gain > 0 then
                    CumulativeGains.evilKarma = CumulativeGains.evilKarma + gain
                    PreviousStats.evilKarma = SelectedPlayer.evilKarma.Value
                end
                
                local gainFull, gainShort = FormatNumber(CumulativeGains.evilKarma)
                gainsText = gainsText .. "Evil Karma: +" .. gainFull .. " | +" .. gainShort .. "\n"
            end
            if SelectedPlayer:FindFirstChild("goodKarma") then
                local full, short = FormatNumber(SelectedPlayer.goodKarma.Value)
                statsText = statsText .. "Good Karma: " .. full .. " | " .. short
                
                if not PreviousStats.goodKarma then
                    PreviousStats.goodKarma = SelectedPlayer.goodKarma.Value
                    CumulativeGains.goodKarma = 0
                end
                
                local gain = SelectedPlayer.goodKarma.Value - PreviousStats.goodKarma
                if gain > 0 then
                    CumulativeGains.goodKarma = CumulativeGains.goodKarma + gain
                    PreviousStats.goodKarma = SelectedPlayer.goodKarma.Value
                end
                
                local gainFull, gainShort = FormatNumber(CumulativeGains.goodKarma)
                if gainsText ~= "" then
                    gainsText = gainsText .. "Good Karma: +" .. gainFull .. " | +" .. gainShort
                else
                    gainsText = "Good Karma: +" .. gainFull .. " | +" .. gainShort
                end
            end

            AllStatsP:Set({
                Title = SelectedPlayer.DisplayName .. " | " .. timerDisplay,
                Content = statsText
            })
            
            GainsP:Set({
                Title = "Gains | " .. timerDisplay,
                Content = gainsText ~= "" and gainsText or "Waiting for gains..."
            })
        end
    end
end)

Library:SetNotification({
    Title = "Player Stats Viewer",
    Description = "Loaded",
    Content = "Dashboard ready",
    Time = 0.5,
    Delay = 3
})
